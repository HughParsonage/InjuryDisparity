---
title: "Inequalities in violent death among men, by state, race, and firearms use"
output:
  word_document:
    reference_docx: reference.docx
bibliography: biblio.bib
---

Corinne A Riddell, PhD

Sam Harper, PhD

Magdalena Cerd√°, PhD

Jay S Kaufman, PhD

CAR, SH, and JK: Department of Epidemiology, Biostatistics & Occupational Health, McGill University, 1020 Pine Avenue West, Room 27, Montreal, QC H3A 1A2, Canada.

MC: Violence Prevention Research Program, Department of Emergency Medicine, University of California, Davis.

Address correspondence to: Corinne Riddell, PhD, Department of Epidemiology, Biostatistics & Occupational Health, McGill University, 1020 Pine Avenue West, Room 27, Montreal, QC H3A 1A2, Canada. Email: <corinne.riddell@mail.mcgill.ca>. Phone: +1-438-863-0402

##### PAGE BREAK

**Abstract**

**Importance:** It is unknown whether and how much the difference in excess deaths due to homicide among black men and suicide among white men varies by US state. Such knowledge could inform social policy aimed towards reducing social disparities in health.

**Objective:** (i) Estimate the absolute inequality between non-Hispanic black and white men and boys in firearm- and non-firearm-related homicide and suicide across US states; (ii) Examine the relationships between state gun ownership prevalence, firearm-related homicide, and firearm-related suicide, separately for black and white men and boys.

**Design:** Cross-sectional study.

**Setting:** 50 states and the District of Columbia, 2008 to 2014.

**Participants:** Non-Hispanic black and non-Hispanic white males, all ages.

**Exposure:** State gun prevalence (%)

**Main Outcomes and Measures:** Risk difference in firearm- and nonfirearm-related homicide and suicide between black men and white men.

**Results:**

**Conclusions and Relevance:**

##### PAGE BREAK

```{r, echo=F, warning=F, message=F}
library(tidyverse)
library(ggrepel)
library(numbr)
library(viridis)
```

```{r gun_ownership_data, echo=F, warning=F, message=F}
gun.house.prev <- c(52.2, 59.8, 32.3, 58.8, 20.1, 34.6, 18.1, 26.3, 25.2,
                    40.3, 10.2, 55.7, 20.7, 38.5, 45.7, 42.8, 47.7, 45.0,
                    40.3, 21.7, 11.5, 40.8, 41.2, 54.6, 44.2, 62.6, 45.4,
                    34.0, 31.0, 11.4, 39.7, 18.5, 39.4, 56.2, 34.0, 46.5,
                    39.8, 35.1, 12.4, 43.3, 59.9, 46.6, 37.1, 44.8, 43.8,
                    37.5, 34.0, 58.5, 43.0, 65.5)

gun.data <- data.frame("ST" = state.abb, "gun.house.prev" = gun.house.prev)

#ggplot(gun.data, aes(gun.house.prev)) + geom_histogram(bins = 20, col = "white") 
#ggplot(gun.data, aes(gun.house.prev)) + geom_density()
#quantile(gun.data$gun.house.prev, c(0.33, 0.66))

gun.data <- gun.data %>% arrange(gun.house.prev) %>% 
  mutate(gun.house.prev.category = cut(gun.house.prev, 
                                       breaks = c(0, 20, 35, 44.9, 66), 
                                       labels = c("10.2%-19.9%", "20.0%-34.9%", "35.0%-44.9%", "45.0%-65.5%")))
```

```{r load_data_age_std_males, echo=F, warning=F, message=F}
#homicide
NHWM_homicide_FA <- read.table("./Data/agestd/Homicide_Firearms_White_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHWM_homicide_NonFA <- read.table("./Data/agestd/Homicide_Non-Firearms_White_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBM_homicide_FA <- read.table("./Data/agestd/Homicide_Firearms_Black_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBM_homicide_NonFA <- read.table("./Data/agestd/Homicide_Non-Firearms_Black_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

#suicide
NHWM_suicide_FA <- read.table("./Data/agestd/Suicide_Firearms_White_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHWM_suicide_NonFA <- read.table("./Data/agestd/Suicide_Non-Firearms_White_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBM_suicide_FA <- read.table("./Data/agestd/Suicide_Firearms_Black_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBM_suicide_NonFA <- read.table("./Data/agestd/Suicide_Non-Firearms_Black_NH_Males_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")
```

```{r load_data_age_std_females, echo=F, warning=F, message=F}
#homicide
NHWF_homicide_FA <- read.table("./Data/agestd/Homicide_Firearms_White_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHWF_homicide_NonFA <- read.table("./Data/agestd/Homicide_Non-Firearms_White_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBF_homicide_FA <- read.table("./Data/agestd/Homicide_Firearms_Black_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBF_homicide_NonFA <- read.table("./Data/agestd/Homicide_Non-Firearms_Black_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

#suicide
NHWF_suicide_FA <- read.table("./Data/agestd/Suicide_Firearms_White_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHWF_suicide_NonFA <- read.table("./Data/agestd/Suicide_Non-Firearms_White_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBF_suicide_FA <- read.table("./Data/agestd/Suicide_Firearms_Black_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")

NHBF_suicide_NonFA <- read.table("./Data/agestd/Suicide_Non-Firearms_Black_NH_Females_Age-adjusted_2008-2014.txt", skip = 21, header = T, sep = ",")
```

```{r tidy_fx, echo=F, warning=F, message=F}
tidy_fx <- function(data, state, death, population, crude, adjusted, race, intent, mechanism) {
  dat2 <- data[, c(state, death, population, crude, adjusted)]
  names(dat2)[2] <- paste0(death, ".", intent, ".", race)
  names(dat2)[3] <- paste0(population, ".", race)
  names(dat2)[4] <- paste0("crude.", intent, ".", race)
  names(dat2)[5] <- paste0("adjusted.", intent, ".", race)
  dat2$type = mechanism
  
  return(dat2)
}
```

```{r tidy_male_data, echo=F}
NHWM_homicide_FA <- tidy_fx(data = NHWM_homicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "homicide", "Firearm")
NHWM_homicide_NonFA <- tidy_fx(data = NHWM_homicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "homicide", "Non-Firearm")
NHWM_suicide_FA <- tidy_fx(data = NHWM_suicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "suicide", "Firearm")
NHWM_suicide_NonFA <- tidy_fx(data = NHWM_suicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "suicide", "Non-Firearm")

NHBM_homicide_FA <- tidy_fx(data = NHBM_homicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "homicide", "Firearm")
NHBM_homicide_NonFA <- tidy_fx(data = NHBM_homicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "homicide", "Non-Firearm")
NHBM_suicide_FA <- tidy_fx(data = NHBM_suicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "suicide", "Firearm")
NHBM_suicide_NonFA <- tidy_fx(data = NHBM_suicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "suicide", "Non-Firearm")

NHBM_homicide<- rbind(NHBM_homicide_FA, NHBM_homicide_NonFA)
NHBM_suicide <- rbind(NHBM_suicide_FA, NHBM_suicide_NonFA)
NHWM_homicide <- rbind(NHWM_homicide_FA, NHWM_homicide_NonFA)
NHWM_suicide <- rbind(NHWM_suicide_FA, NHWM_suicide_NonFA)
rm(NHBM_homicide_FA, NHBM_homicide_NonFA, NHBM_suicide_FA, NHBM_suicide_NonFA,
   NHWM_homicide_FA, NHWM_homicide_NonFA, NHWM_suicide_FA, NHWM_suicide_NonFA)
```

```{r tidy_female_data, echo = F}
NHWF_homicide_FA <- tidy_fx(data = NHWF_homicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "homicide", "Firearm")
NHWF_homicide_NonFA <- tidy_fx(data = NHWF_homicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "homicide", "Non-Firearm")
NHWF_suicide_FA <- tidy_fx(data = NHWF_suicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "suicide", "Firearm")
NHWF_suicide_NonFA <- tidy_fx(data = NHWF_suicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "white", "suicide", "Non-Firearm")

NHBF_homicide_FA <- tidy_fx(data = NHBF_homicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "homicide", "Firearm")
NHBF_homicide_NonFA <- tidy_fx(data = NHBF_homicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "homicide", "Non-Firearm")
NHBF_suicide_FA <- tidy_fx(data = NHBF_suicide_FA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "suicide", "Firearm")
NHBF_suicide_NonFA <- tidy_fx(data = NHBF_suicide_NonFA, "ST", "Deaths", "Population", "U_C_Rate", 
                            "U_A_Rate", "black", "suicide", "Non-Firearm")

NHBF_homicide<- rbind(NHBF_homicide_FA, NHBF_homicide_NonFA)
NHBF_suicide <- rbind(NHBF_suicide_FA, NHBF_suicide_NonFA)
NHWF_homicide <- rbind(NHWF_homicide_FA, NHWF_homicide_NonFA)
NHWF_suicide <- rbind(NHWF_suicide_FA, NHWF_suicide_NonFA)
rm(NHBF_homicide_FA, NHBF_homicide_NonFA, NHBF_suicide_FA, NHBF_suicide_NonFA,
   NHWF_homicide_FA, NHWF_homicide_NonFA, NHWF_suicide_FA, NHWF_suicide_NonFA)
```

```{r merge_data_males, echo=F}
#merge all the data
Males_AllAges_0814 <- merge(NHBM_homicide, NHBM_suicide %>% select(-Population.black), by = c("ST", "type")) %>%
  mutate(crude.RD.hom.su.black = crude.homicide.black - crude.suicide.black,
         adj.RD.hom.su.black = adjusted.homicide.black - adjusted.suicide.black)

Males_AllAges_0814 <- merge(Males_AllAges_0814, NHWM_homicide, by = c("ST", "type")) %>%
  mutate(crude.RD.homicide = crude.homicide.black - crude.homicide.white,
         adj.RD.homicide = adjusted.homicide.black - adjusted.homicide.white)

Males_AllAges_0814 <- merge(Males_AllAges_0814, NHWM_suicide %>% select(-Population.white), by = c("ST", "type")) %>%
  mutate(crude.RD.suicide = crude.suicide.black - crude.suicide.white,
         adj.RD.suicide = adjusted.suicide.black - adjusted.suicide.white)

Males_AllAges_0814 <- Males_AllAges_0814 %>% 
  mutate(crude.RD.hom.su.white = crude.homicide.white - crude.suicide.white, 
         adj.RD.hom.su.white = adjusted.homicide.white - adjusted.suicide.white)
```

```{r merge_data_females, echo=F}
Females_AllAges_0814 <- merge(NHBF_homicide, NHBF_suicide %>% select(-Population.black), by = c("ST", "type")) %>%
  mutate(crude.RD.hom.su.black = crude.homicide.black - crude.suicide.black,
         adj.RD.hom.su.black = adjusted.homicide.black - adjusted.suicide.black)

Females_AllAges_0814 <- merge(Females_AllAges_0814, NHWF_homicide, by = c("ST", "type")) %>%
  mutate(crude.RD.homicide = crude.homicide.black - crude.homicide.white,
         adj.RD.homicide = adjusted.homicide.black - adjusted.homicide.white)

Females_AllAges_0814 <- merge(Females_AllAges_0814, NHWF_suicide %>% select(-Population.white), by = c("ST", "type")) %>%
  mutate(crude.RD.suicide = crude.suicide.black - crude.suicide.white,
         adj.RD.suicide = adjusted.suicide.black - adjusted.suicide.white)

Females_AllAges_0814 <- Females_AllAges_0814 %>% 
  mutate(crude.RD.hom.su.white = crude.homicide.white - crude.suicide.white, 
         adj.RD.hom.su.white = adjusted.homicide.white - adjusted.suicide.white)
```

```{r add_factor_sorting_males, echo = F}
#used for plotting -- to arrange the states on the y-axis according to the magnitude of the black-white inequality
levels.firearm.homicide <- Males_AllAges_0814 %>% filter(type == "Firearm") %>%
  transmute(ST.order.RD.homicide = reorder(ST, adj.RD.homicide))

# Males_AllAges_0814 %>% 
#   filter(is.na(adjusted.homicide.black) == T & type == "Firearm") %>% 
#   select(ST, adjusted.homicide.white)

Males_AllAges_0814$ST.order.RD.homicide <- factor(Males_AllAges_0814$ST, 
                                                  levels = c("HI", "SD", "NH", "ND", "VT", "ID", "ME", "WY", "MT",
                                                             levels(levels.firearm.homicide$ST.order.RD.homicide)[1:42]))

levels.firearm.suicide <- Males_AllAges_0814 %>% filter(type == "Firearm") %>%
  transmute(ST.order.RD.suicide = reorder(ST, -adj.RD.suicide))

# Males_AllAges_0814 %>% 
#   filter(is.na(adjusted.suicide.black) == T & type == "Firearm") %>% 
#   select(ST, adjusted.suicide.white)

Males_AllAges_0814$ST.order.RD.suicide <- factor(Males_AllAges_0814$ST, 
                                                  levels = c("RI", "HI", "IA", "NH", "ME", "SD", "ND", "VT", "UT", "ID", "MT", "WY",
                                                             levels(levels.firearm.suicide$ST.order.RD.suicide)[1:39]))

```

```{r add_factor_sorting_females, echo = F}
#used for plotting -- to arrange the states on the y-axis according to the magnitude of the black-white inequality
levels.firearm.homicide <- Females_AllAges_0814 %>% filter(type == "Firearm") %>%
  transmute(ST.order.RD.homicide = reorder(ST, adj.RD.homicide))

# Females_AllAges_0814 %>% 
#   filter(is.na(adjusted.homicide.black) == T & type == "Firearm") %>% 
#   select(ST, adjusted.homicide.white)

Females_AllAges_0814$ST.order.RD.homicide <- factor(Females_AllAges_0814$ST, 
                                                  levels = levels(levels.firearm.homicide$ST.order.RD.homicide))

# Males_AllAges_0814$ST.order.RD.homicide <- factor(Males_AllAges_0814$ST, 
#                                                   levels = c("HI", "SD", "NH", "ND", "VT", "ID", "ME", "WY", "MT",
#                                                              levels(levels.firearm.homicide$ST.order.RD.homicide)[1:42]))

levels.firearm.suicide <- Females_AllAges_0814 %>% filter(type == "Firearm") %>%
  transmute(ST.order.RD.suicide = reorder(ST, -adj.RD.suicide))

# Females_AllAges_0814 %>% 
#   filter(is.na(adjusted.suicide.black) == T & type == "Firearm") %>% 
#   select(ST, adjusted.suicide.white)

# Females_AllAges_0814$ST.order.RD.suicide <- factor(Females_AllAges_0814$ST, 
#                                                   levels = c("RI", "HI", "IA", "NH", "ME", "SD", "ND", "VT", "UT", "ID", "MT", "WY",
#                                                              levels(levels.firearm.suicide$ST.order.RD.suicide)[1:39]))

Females_AllAges_0814$ST.order.RD.suicide <- factor(Females_AllAges_0814$ST, 
                                                  levels = levels(levels.firearm.suicide$ST.order.RD.suicide))

```

```{r add_variables_males, echo=F}
num.years = 2014-2008+1

Males_AllAges_0814 <- Males_AllAges_0814 %>% 
  mutate(average.pop.white = Population.white/num.years,
         average.pop.black = Population.black/num.years)

Males_AllAges_0814$gun.level <- "Middle"
Males_AllAges_0814$gun.level[Males_AllAges_0814$ST %in% c("LA", "UT", "OK", "IA", "TN","KY", "AL", 
                                                          "MS", "ID","ND", "WV", "AR", "AK", "SD", "MT", "WY")] <- "High"
Males_AllAges_0814$gun.level[Males_AllAges_0814$ST %in% c("HI", "NJ", "MA", "RI", "CT", "NY")] <- "Low"

Males_AllAges_0814$gun.level <- factor(Males_AllAges_0814$gun.level, levels = c("Low", "Middle", "High"))

#dim(Males_AllAges_0814)
Males_AllAges_0814 <- merge(Males_AllAges_0814, gun.data, by = "ST", all.x = T)
#dim(Males_AllAges_0814)
```

```{r add_variables_females, echo=F}
Females_AllAges_0814 <- Females_AllAges_0814 %>% 
  mutate(average.pop.white = Population.white/num.years,
         average.pop.black = Population.black/num.years)

Females_AllAges_0814$gun.level <- "Middle"
Females_AllAges_0814$gun.level[Females_AllAges_0814$ST %in% c("LA", "UT", "OK", "IA", "TN","KY", "AL", 
                                                          "MS", "ID","ND", "WV", "AR", "AK", "SD", "MT", "WY")] <- "High"
Females_AllAges_0814$gun.level[Females_AllAges_0814$ST %in% c("HI", "NJ", "MA", "RI", "CT", "NY")] <- "Low"

Females_AllAges_0814$gun.level <- factor(Females_AllAges_0814$gun.level, levels = c("Low", "Middle", "High"))

#dim(Females_AllAges_0814)
Females_AllAges_0814 <- merge(Females_AllAges_0814, gun.data, by = "ST", all.x = T)
#dim(Females_AllAges_0814)
```

**Introduction**

```{r WISQARS-data-intro, echo=F}
#source: WISQARS fatal injury mapping tool
#note:I uses homicide, not homicide and legal intervention -- this changes the numbers slightly, not materially. 

#HOMICIDE relative risks
nh.black.homicide.rate.agestd <- 33.58 #per 100k, annualized age standardized, 2008-2004, entire US, black, non-hispanic, males
nh.black.homicide.rate.crude <- 35.53 #per 100k, annualized crude, 2008-2004, entire US, black, non-hispanic, males

nh.white.homicide.rate.agestd <- 3.46 #per 100k, annualized age standardized, 2008-2004, entire US, white, non-hispanic, males
nh.white.homicide.rate.crude <- 3.45 #per 100k, annualized crude, 2008-2004, entire US, white, non-hispanic, males

rr.homicide.black.white.agestd <- nh.black.homicide.rate.agestd/nh.white.homicide.rate.agestd
rr.homicide.black.white.crude <- nh.black.homicide.rate.crude/nh.white.homicide.rate.crude

#SUICIDE relative risks
nh.black.suicide.rate.agestd <- 9.64 #per 100k, annualized age standardized, 2008-2004, entire US, black, non-hispanic, males
nh.black.suicide.rate.crude <- 9.32 #per 100k, annualized crude, 2008-2004, entire US, black, non-hispanic, males

nh.white.suicide.rate.agestd <- 24.49 #per 100k, annualized age standardized, 2008-2004, entire US, white, non-hispanic, males
nh.white.suicide.rate.crude <- 26.01 #per 100k, annualized crude, 2008-2004, entire US, white, non-hispanic, males

rr.suicide.white.black.agestd <- nh.white.suicide.rate.agestd/nh.black.suicide.rate.agestd
rr.suicide.white.black.crude <- nh.white.suicide.rate.crude/nh.black.suicide.rate.crude

```

```{r WISQARS-data-intro-2, echo=F}

risk.homicide.nh.male <- 8.33 #per 100k, non-hispanic blacks + whites, 2008-2014, males
risk.homicide.nh.male.firearm <- 6.17 #per 100k, non-hispanic blacks + whites, 2008-2014, males
prop.homicide.nh.male.firearm <- (risk.homicide.nh.male.firearm/risk.homicide.nh.male)*100

risk.suicide.nh.male <- 22.42 #per 100k, non-hispanic blacks + whites, 2008-2014, males
risk.suicide.nh.male.firearm <- 12.87 #per 100k, non-hispanic blacks + whites, 2008-2014, males
prop.suicide.nh.male.firearm <- (risk.suicide.nh.male.firearm/risk.suicide.nh.male)*100
```

```{r WISQARS-data-intro-3, echo=F}
#source: WISQARS fatal injury mapping tool
#note:I uses homicide, not homicide and legal intervention -- this changes the numbers slightly, not materially. 

#FIREARM HOMICIDE relative risks
nh.black.homicide.rate.agestd.fa <- 27.58 #per 100k, annualized age standardized, 2008-2004, entire US, black, non-hispanic, males
nh.black.homicide.rate.crude.fa <- 29.57 #per 100k, annualized crude, 2008-2004, entire US, black, non-hispanic, males

nh.white.homicide.rate.agestd.fa <- 2.04 #per 100k, annualized age standardized, 2008-2004, entire US, white, non-hispanic, males
nh.white.homicide.rate.crude.fa <- 2.01 #per 100k, annualized crude, 2008-2004, entire US, white, non-hispanic, males

rr.homicide.black.white.agestd.fa <- nh.black.homicide.rate.agestd.fa/nh.white.homicide.rate.agestd.fa
rr.homicide.black.white.crude.fa <- nh.black.homicide.rate.crude.fa/nh.white.homicide.rate.crude.fa

#FIREARM SUICIDE relative risks
nh.black.suicide.rate.agestd.fa <- 5.33 #per 100k, annualized age standardized, 2008-2004, entire US, black, non-hispanic, males
nh.black.suicide.rate.crude.fa <- 5.04 #per 100k, annualized crude, 2008-2004, entire US, black, non-hispanic, males

nh.white.suicide.rate.agestd.fa <- 14.06 #per 100k, annualized age standardized, 2008-2004, entire US, white, non-hispanic, males
nh.white.suicide.rate.crude.fa <- 15.27 #per 100k, annualized crude, 2008-2004, entire US, white, non-hispanic, males

rr.suicide.white.black.agestd.fa <- nh.white.suicide.rate.agestd.fa/nh.black.suicide.rate.agestd.fa
rr.suicide.white.black.crude.fa <- nh.white.suicide.rate.crude.fa/nh.black.suicide.rate.crude.fa

```

Non-Hispanic black males are `r round(rr.homicide.black.white.agestd,1)` times more likely to die from homicide than non-Hispanic white males in the United States, while white males are `r round(rr.suicide.white.black.agestd,1)` times more likely to die from suicide [@wisqars_data]. `r round(prop.homicide.nh.male.firearm)`% of these homicides and `r round(prop.suicide.nh.male.firearm)`% of these suicides involved firearms, and the relative inequalities in violent deaths are especially marked for firearm-related homicide and slightly increased for suicide; Black males are `r round(rr.homicide.black.white.agestd.fa,1)` times more likely to die of a firearm-related homicide than white males, while white males are `r round(rr.suicide.white.black.agestd,1)` times as likely to die from firearm-related suicide [@wisqars_data]. 

While these racial inequalities in violent deaths are well-established for the United States overall, it is unknown whether and how much they vary by state. Large variation between racial inequalities in spatially contiguous or otherwise similar states may reflect differences in social policy worthy of further investigation. Looking forward, this information is the first step towards implementing targeted policies aimed at reducing inequalities where they are most urgently needed. Reduction of the overall firearm-related mortality is an important public health pursuit in its own right [Editorial in PrevMed], however, reductions in inequalities are also important, especially if they are considered inequities associated with more adverse social conditions linked to race or ethnicity.[arcaya2015inequalities]. 

Across the US, states with the highest levels of household gun ownership have higher rates of firearm-related suicide and homicide [@webster_book_table]. Ecologic studies have estimated positive associations between rates of gun ownership and firearm-related homicide and suicide rates, while case-control studies how found positive associations between having a gun in the home and an individual‚Äôs risk of homicide occurring at home, and with the overall risk of suicide [References]. If the dynamics of where homicides or suicides occur (at home vs. outside of the home) vary by race, then the relationship between gun prevalence and firearm fatalities may be differential by race. This information is currently unknown but is important to inform whether policies aimed at reducing gun prevalence may have differential effects among blacks and whites. 

In this study, we aimed to: (1) Estimate the absolute inequality between non-Hispanic black and white men and boys in firearm- and non-firearm-related homicide and suicide across US states; (2) Examine the relationships between state gun ownership prevalence, firearm-related homicide, and firearm-related suicide, separately for black and white men and boys.

**Methods**

We used the Center for Disease Control and Prevention‚Äôs Web-based Injury Statistics Query and Reporting System (WISQARS) Fatal Injury Mapping tool to abstract the age-adjusted number of firearm fatalities for males in every state during 2008 to 2014 for non-Hispanic whites and non-Hispanic blacks, by intent (homicide or suicide), and mechanism (firearms or non-firearms). We computed the average yearly fatality rate according to sex, intent, and firearms usage by dividing the number of fatalities by the total population estimate (i.e., the summation of population estimates over 2008 to 2014) and we calculated the inequality in estimates between black and white males. For any state-race stratum, the number of age-adjusted deaths was suppressed by WISQARS if ten or fewer actual deaths occurred during the time period, and thus could not be used in these analyses. We did not calculate confidence intervals because there was no sampling, and thus no sampling error. To reflect varying population sizes among states and between races, we size the data markers according to race-specific average annualized population such that larger symbols reflect more stable estimates. 

To examine the relationships between gun prevalence, firearm-related homicide, and firearm-related suicide by race, we used the last available state-level estimates of household firearm ownership from the National Behaviourial Risk Factor Surveillance System (BRFSS) from 2004. The BRFSS is an annual telephone survey on the non-institutionalized adult population that asks respondents about their health-related risk behaviors, chronic health conditions, and use of preventive services. In 2001, 2002, and 2004, the BRFSS asked, ‚ÄúAre any firearms kept in or around your home?‚Äù 293,882 people responded to this question and estimates of household gun ownership prevalence (%) by state were computed previously [@monuteaux2015firearm]. Given that individuals may lie about gun ownership, and that state gun ownership prevalence may have shifted since 2004, we grouped states into four levels covering the range of gun prevalence: (i) 10.2% - 19.9%, (ii) 20% - 34.9%, (iii) 35% - 44.9%, and (iv) 45% - 65.5%, to provide a proxy for current levels of ownership. 

We then visually assessed the relationships between gun prevalence, firearm-related homicide, and firearm-related suicide by graphing the rate of firearm-related homicide as a function of firearm-related suicide and shading the points by category of gun prevalence, separately for black men and white men. Correlation between rates of firearm-related homicide and suicide would imply that state conditions that generate variation in homicide also generate variation in suicide, such as the cultural, social, or economic conditions that vary among states, including (but not limited to) levels of gun ownership or the firearm policy environment. Thus, the purpose of this descriptive exercise was to describe whether states with relatively high rates in firearm-related homicide also have relatively high rates of firearm-related suicide, and if this pattern exists within race strata. 

The analysis was performed in R version 3.3.2,[@r_language] with all code available on Github (link: https://github.com/corinne-riddell/InjuryDisparity).

**Results**

```{r results_statistics, echo=F}
stats <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adj.RD.homicide, na.rm = T)), max = round(max(adj.RD.homicide, na.rm = T)))

stats2 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adjusted.homicide.white, na.rm = T)), max = round(max(adjusted.homicide.white, na.rm = T)))

white.pop.dc <- Males_AllAges_0814 %>% filter(ST == "DC" & type == "Firearm") %>% select(Population.white)

stats3 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adjusted.homicide.black, na.rm = T)), max = round(max(adjusted.homicide.black, na.rm = T)))
```

**Figure 1** displays the heightened rates of homicide fatality among black males compared to white males, according to state and the use of firearms. The black-white difference in homicide fatality rates for men varies strikingly by state, between `r stats$min[1]` and `r stats$max[1]` per 100,000 per year, and are driven by marked variation in firearm homicides to black men across states. States with the smallest black firearm homicide rates saw fewer than 15 deaths per 100,000 per year over the time period, compared to more than 40 deaths per 100,000 per year in states with the highest rates. Homicide rates for white male, showed relatively little variation, between `r stats2$min[1]` and `r stats2$max[1]` deaths per 100,000 per year. The states with the highest rates of firearm homicide for black men (e.g., Missouri, Michigan, Illinois, Indiana) also have have the largest difference in rates between blacks and whites, signaling settings that are most dangerous for blacks but relatively safer for whites. The District of Columbia also has a high rate of firearm homicide for blacks, but its rate for white men was supressed. Given its supplied cumulative population denominator of `r white.pop.dc` white men observed over 2008 to 2014, this implies a rate <= `r round((10/white.pop.dc)*100000, 1)` per 100,000, implying that DC is also relatively dangerous for black men, but not for white men.

Georgia, New York, Florida, Texas, and California are the states with the largest black populations. Among them, Texas exhibited the smallest black-white difference in firearm-related homicide (13 excess deaths to black men per 100,000), which was also substantially lower than the differences estimated for neighboring states like Louisiana (+37/100,000), Oklahoma (+29/100,000), and Arkansas (+29/100,000). Georgia (+16/100,000) and Florida (+22/100,000) had differences close to nearby South and North Carolina (+19 and +17 per 100,000, respectively), while having lower rates than Alabama (+27/100,000) and Tennessee (+28/100,000). New York's difference (+18/100,000) was similar to that estimated for Massachusettes (+17/100,000) and Connecticut (+22/100,000), but was substantially lower than the rates neighboring in New Jersey (+30/100,000) and Pennsylvania (+41/100,000). California's exhibited the largest black-white difference in firearm-related homicide among the set of states with the highest black populations (+30/100,000), which was larger than the rates estimates for contiguous states like Nevada (+17/100,000) and Oregon (+10/100,000), although other Western states have very small black populations.

Non-firearm homicides occur relatively rarely, and maintain the general pattern of heightened rates among black men compared to white men. While blacks experience annual rates that vary between `r stats3$min[2]` and `r stats3$max[2]` per 100,000 by state, white rates varied between `r stats2$min[2]` and `r stats2$max[2]` per 100,000. Across the US, firearm homicide rates are higher than non-firearm rates for black men, and are more than 5.3 times as high in all states in the East North Central (Wisconsin, Illinois, Indiana, Ohio, and Michigan), Missouri, Louisiana, Delaware, and Nebraska.

```{r results_statistics_suicide, echo=F}
stats4 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adj.RD.suicide, na.rm = T)),
                                                    max = round(max(adj.RD.suicide, na.rm = T)))

stats5 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adjusted.suicide.white, na.rm = T)),
                                                    max = round(max(adjusted.suicide.white, na.rm = T)))

stats6 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adjusted.suicide.black, na.rm = T)),
                                                    max = round(max(adjusted.suicide.black, na.rm = T)))

stats7 <- Males_AllAges_0814 %>% group_by(type) %>% summarise(min = round(min(adjusted.suicide.white, na.rm = T)),
                                                    max = round(max(adjusted.suicide.white, na.rm = T)))
```

In contrast to homicide, suicide fatality rates are higher among white men compared to black men, independent of firearms usage, with the exception of firearm-related suicide in DC (**Figure 2**). The white-black difference in suicides involving a firearm varied from `r -(stats4$max[1])` in the District of Columbia to `r -(stats4$min[1])` per 100,000 per year in Missouri, although differences could not be estimated for 12 states with 10 or fewer firearm-related suicides among blacks. The annual rate of suicides involving firearms varies more markedly for white men than for black men, between `r stats5$min[1]` (DC) and `r stats5$max[1]` (Wyoming) per 100,000 compared to a range of `r stats6$min[1]` (Massachusetts) to `r stats6$max[1]` (New Mexico) per 100,000 among black men. 

Seven of the ten states with the largest white-black firearm differences in suicide are located in the South (Mississippi, Arkansas, West Virginia, Alabama, Texas, South Carolina, and Louisiana), while the remaining three are in the West (Nevada, Arizona, and Colorado). Along with DC, the mid-Atlantic states of Massachusetts, New Jersey, Connecticut, and New York rounded out the states with the smallest white-black differences in firearm-related suicide. 

The rates of black- and white- non-firearm suicides and the difference between them vary substantially less than those involving firearms. For white men, between `r stats7$min[2]` and `r stats7$max[2]` per 100,000 non-firearm suicides are committed each year on average across the states, compared to  `r stats6$min[2]` and `r stats6$max[2]` per 100,000 non-firearm suicides among blacks.

The five states with jointly low rates of firearm-related homicide and suicide among white men (i.e., Massachusetts, New Jersey, Rhode Island, New York, and Connecticut) have the lowest category of gun prevalence (**Figure 3**). Furthermore, many of the states with the highest joint violence rates belong to the highest category of gun prevalence, while most states located in the middle of the graph belong to the middle category of gun prevalence. Notably, several states belonging to the highest gun prevalence category have relatively low rates of firearm-related homicide, including Iowa, Nebraska, the Dakotas, Idaho, Montana, and Wyoming. 

Among black men, states with the lowest prevalence of guns had the lowest rates of firearm-related suicide, and below-average rates of firearm-related homicide (**Figure 4**). States with the highest joint rates of violence (i.e., Mississippi, Missouri, Oklahoma) had heightened rates of gun prevalence, although several Southern states with relatively high gun prevalence had relatively low rates of firearm-related homicide.  

##### PAGE BREAK

**Figure 1: Difference in age-standardized homicide fatalities rates for males by state, firearms, and race, 2008-2014**

```{r figure1, fig.width=5, fig.height=6.5, echo = F, warning=F}
ggplot(Males_AllAges_0814, aes(y = ST.order.RD.homicide, x = adjusted.homicide.white)) + 
  geom_segment(aes(x = adjusted.homicide.white, xend = adjusted.homicide.black, 
                   y = ST.order.RD.homicide, yend = ST.order.RD.homicide), 
               lwd = 2, col = "navy", alpha = 0.5) +
  geom_point(aes(col = "NH White", size = average.pop.white)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  geom_point(aes(x = adjusted.homicide.black, col = "NH Black", size = average.pop.black)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1),
  scale_color_manual(values = c("navy", "#fd8d3c")) +
  scale_alpha_continuous(guide = F) +
  scale_size_area(breaks = c(16600, 100000, 500000, 1500000, 3000000, 7000000)) +
  ylab("") +
  xlab("Homicide mortality per 100k") + 
  theme_bw() + 
  guides(color = guide_legend(title = " "), size = guide_legend(title = "Population")) + 
  theme(legend.position = c(0.8, 0.25), 
        plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2)),
        strip.background = element_rect(fill="white"), 
        strip.text.x = element_text(size = 12),
        strip.text.y = element_text(size = 12)) + 
  scale_x_continuous(limits = c(0, 60), labels = seq(0, 60, 20), breaks = seq(0, 60, 20)) +
  geom_text(data = subset(Males_AllAges_0814, is.na(adj.RD.homicide)==F),
            aes(x = adjusted.homicide.black + 8, label = paste0("+", round(adj.RD.homicide))),
            size = 3, col = "navy") +
  facet_wrap( ~ type)  
```

##### PAGE BREAK

**Figure 2: Difference in suicide fatalities rates for males by state, firearms, and race, 2008-2014**

```{r figure2, fig.width=5, fig.height=6.5, echo = F, warning=F}
ggplot(Males_AllAges_0814, aes(y = ST.order.RD.suicide, x = adjusted.suicide.white)) + 
  geom_segment(aes(x = adjusted.suicide.white, xend = adjusted.suicide.black, 
                   y = ST.order.RD.suicide, yend = ST.order.RD.suicide), 
               lwd = 2, col = "#fd8d3c", alpha = 0.5) +
  geom_point(aes(col = "NH White", size = average.pop.white)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  geom_point(aes(x = adjusted.suicide.black, col = "NH Black", size = average.pop.black)) + #, alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  scale_color_manual(values = c("navy", "#fd8d3c")) +
  scale_alpha_continuous(guide = F) +
  scale_size_area(breaks = c(16600, 100000, 500000, 1500000, 3000000, 7000000)) +
  ylab("") + xlab("Suicide mortality per 100k") + theme_bw() + 
  guides(color = guide_legend(title = " "), size = guide_legend(title = "Population")) + 
  theme(legend.position = c(0.85, 0.25), 
        plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2)),
        strip.background = element_rect(fill="white"), 
        strip.text.x = element_text(size = 12),
        strip.text.y = element_text(size = 12)) + 
  scale_x_continuous(limits = c(0, 60), labels = seq(0, 60, 20), breaks = seq(0, 60, 20)) +
  geom_text(data = subset(Males_AllAges_0814, is.na(adj.RD.suicide)==F), 
            aes(x = adjusted.suicide.white + 8, label = paste0("+", round(-adj.RD.suicide))), size = 3, col = "#fd8d3c") +
  facet_wrap(~type)
```

##### PAGE BREAK

**Figure 3: The relationship between the rate of homicide and suicides among whites males by state, 2008-2014**

```{r Figure3, fig.width=6, fig.height=6, echo = F, warning=F}
ggplot(subset(Males_AllAges_0814, type == "Firearm" & ST != "DC"), aes(adjusted.suicide.white, adjusted.homicide.white)) + 
  geom_point(aes(fill = gun.house.prev.category, size = average.pop.white), col = "black", pch = 21, alpha = 0.9) +
  geom_text_repel(aes(label = ST), alpha = 0.8, size = 3) +
  scale_fill_viridis(discrete = T, direction = -1) +
  ylab("White Homicide Rate\n(per 100,000)") +
  xlab("White Suicide Rate (per 100,000)") + 
  theme_bw() +
  theme(legend.position = "bottom") +
  scale_size_area(breaks = c(100000, 500000, 1500000, 3000000, 7000000), max_size = 15, guide = F) +
  guides(fill = guide_legend(title = "Gun ownership", override.aes = list(size = 5)))

# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(adjusted.suicide.white, adjusted.homicide.white)) + 
#   geom_point(aes(fill = gun.level, size = average.pop.white), col = "white", pch = 21, alpha = 0.5) +
#   geom_text_repel(aes(label = ST), alpha = 0.8, size = 3) +
#   ylab("White Homicide Rate\n(per 100,000)") +
#   xlab("White Suicide Rate (per 100,000)") + 
#   theme_bw() +
#   scale_size_area(breaks = c(100000, 500000, 1500000, 3000000, 7000000), max_size = 15, guide = F) +
#   guides(fill = guide_legend(title = "Gun ownership")) 
```

##### PAGE BREAK

**Figure 4: The relationship between the rate of homicide and suicides among black males by state, 2008-2014**

```{r figure4, fig.width = 6, fig.height = 6, echo=F, warning=F}
ggplot(subset(Males_AllAges_0814, type == "Firearm" & ST != "DC"), aes(adjusted.suicide.black, adjusted.homicide.black)) + 
  geom_point(aes(fill = gun.house.prev.category, size = average.pop.black), col = "black", pch = 21, alpha = 0.9) +
  geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) +
  scale_fill_viridis(discrete = T, direction = -1) +
  ylab("Black Homicide Rate\n(per 100,000)") +
  xlab("Black Suicide Rate (per 100,000)") + 
  theme_bw() +
  theme(legend.position = "bottom") +
  scale_size_area(breaks = c(16600, 100000, 500000, 1400000), max_size = 15, guide = F) +
  guides(fill = guide_legend(title = "Gun ownership", override.aes = list(size = 5))) 
    
# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(adjusted.suicide.black, adjusted.homicide.black)) + 
#   geom_point(aes(fill = gun.level, size = average.pop.black), col = "white", pch = 21, alpha = 0.5) +
#   geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) +
#   ylab("Black Homicide Rate\n(per 100,000)") +
#   xlab("Black Suicide Rate (per 100,000)") + 
#   theme_bw() +
#   scale_size_area(breaks = c(16600, 100000, 500000, 1400000), max_size = 15, guide = F) +
#   guides(fill = guide_legend(title = "Gun ownership"))

# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(x = gun.house.prev, y = adj.RD.homicide)) +
#          geom_point() +
#   geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) 
# 
# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(x = gun.house.prev, y = adj.RD.suicide)) +
#          geom_point() +
#   geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) +
#   geom_smooth()
# 
# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(x = gun.house.prev, y = Population.white)) +
#          geom_point() + geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) 
# 
# ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(x = gun.house.prev, y = Population.black)) +
#          geom_point() + geom_text_repel(aes(label = ST), alpha = 0.8, size = 3, check_overlap = T) 
```

**Discussion**

- Homicide committed by firearm exhibits striking variation by state among blacks, and suicide exhibits variation (not quite so much) by firearm among whites. 

- In recent times, much focus has been paid to whites and their increased rates of death from so-called 'diseases of dispair': suicide, drug overdoses, alcoholism.

- This report highlights the costs (in lives lost) to blacks due to firearm homicide. Homicide is not considered a disease of dispair, and yet it leads to many years of life lost to blacks males (I know this is estimated somewhere... just need to find it) because deaths due to homicide begin to materially affect blacks beginning in early adulthood. 

- The variation in the disparity between blacks and whites in firearm homicides is massive. States that are relatively safe for white men are unsafe for blacks and indicate heightened violence experienced by blacks in states such as Missouri, Michigan, Illinois, Pennsylvania, and in the District of Columbia.

- While we usually think of the South and Mountains states as having the most guns and gun-related deaths, this experience is proving differential by race. While the states with the fewest guns have the lowest white homicide (< 3/100k) and suicide rates (<22/100k excluding HI), blacks do not enjoy these same benefits in terms of homicide. Homicide among black males is so high that it has been estimated to reduce their life expectancy by 2.1 years among black males in Los Angeles county, and up to 5 years in some low income neighborhoods. [Redelings, 2010 J Urban Health]  

- Guns feature differently in the lives of blacks and whites. For whites, suicides by firearm are very high. Lots of literature linking suicide rates to gun laws and availability (see the Hopkins report about this and cite the most robust findings). For blacks, guns are most implicated in homicide. Future research: do places with more social adversity for blacks have higher rates of firearm homicide for blacks/greater inequalities? What are the characteristics that predict high homicide rates for blacks and large gaps? Possibility: Can look at a more micro-level but this might prohibit direct comparison by race give the high level of racial segregation of neighborhoods.

*Limitations*
- We only looked at fatalities. Had we been able to include non-fatal injuries, it is likely that many attempted homicides would be captured because the fatality rate of attempted homicide is relatively low (20-something %) compared to 80-something percent for suicides.[ref] Non-fatal injuries could have been measured using ED data, such as the NEISS-AIP and the NEDS but neither of these data sources can be used to compute state-level estimates and the NEDS does not include race. Thus, focusing only on fatalities tells a more complete story for inequalities in firearm suicide than for firearm homicide, implying that much of the morbidity suffered by blacks because of firearm homicide is missed.

*Strengths*
- The first exposition of racial inequalities in firearm violence by state. 

**Public Health Implications**


#####PAGE BREAK

**Other graphs, fyi**

**Figure 1b: Difference in age-standardized homicide fatalities rates for females by state, firearm involvement, and race, 2008-2014**

```{r figure1b, fig.width=5, fig.height=7, echo = F, warning=F}
ggplot(Females_AllAges_0814, aes(y = ST.order.RD.homicide, x = adjusted.homicide.white)) + 
  geom_segment(aes(x = adjusted.homicide.white, xend = adjusted.homicide.black, 
                   y = ST.order.RD.homicide, yend = ST.order.RD.homicide), 
               lwd = 2, col = "navy", alpha = 0.5) +
  geom_point(aes(col = "NH White", size = average.pop.white)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  geom_point(aes(x = adjusted.homicide.black, col = "NH Black", size = average.pop.black)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1),
  scale_color_manual(values = c("navy", "#fd8d3c")) +
  scale_alpha_continuous(guide = F) +
  scale_size_area(breaks = c(16600, 100000, 500000, 1500000, 3000000, 7000000)) +
  ylab("") +
  xlab("Homicide mortality per 100k") + 
  theme_bw() + 
  guides(color = guide_legend(title = " "), size = guide_legend(title = "Population")) + 
  theme(legend.position = c(0.8, 0.25), 
        plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2)),
        strip.background = element_rect(fill="white"), 
        strip.text.x = element_text(size = 12),
        strip.text.y = element_text(size = 12)) + 
  scale_x_continuous(limits = c(0, 80), labels = seq(0, 80, 20), breaks = seq(0, 80, 20)) +
  geom_text(data = subset(Females_AllAges_0814, is.na(adj.RD.homicide)==F),
            aes(x = adjusted.homicide.black + 2, label = paste0("+", round(adj.RD.homicide))),
            size = 3, col = "navy") +
  facet_wrap( ~ type)  
```

**Figure 2b: Difference in suicide fatalities rates for females by state, firearm involvement, and race, 2008-2014**

```{r figure2b, fig.width=5, fig.height=7, echo = F, warning=F}
ggplot(Females_AllAges_0814, aes(y = ST.order.RD.suicide, x = adjusted.suicide.white)) + 
  geom_segment(aes(x = adjusted.suicide.white, xend = adjusted.suicide.black, 
                   y = ST.order.RD.suicide, yend = ST.order.RD.suicide), 
               lwd = 2, col = "#fd8d3c", alpha = 0.5) +
  geom_point(aes(col = "NH White", size = average.pop.white)) + #alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  geom_point(aes(x = adjusted.suicide.black, col = "NH Black", size = average.pop.black)) + #, alpha = ifelse(death.homicide.black < 20, 0.7, 1)
  scale_color_manual(values = c("navy", "#fd8d3c")) +
  scale_alpha_continuous(guide = F) +
  scale_size_area(breaks = c(16600, 100000, 500000, 1500000, 3000000, 7000000)) +
  ylab("") + xlab("Suicide mortality per 100k") + theme_bw() + 
  guides(color = guide_legend(title = " "), size = guide_legend(title = "Population")) + 
  theme(legend.position = c(0.8, 0.25), 
        plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2)),
        strip.background = element_rect(fill="white"), 
        strip.text.x = element_text(size = 12),
        strip.text.y = element_text(size = 12)) + 
  scale_x_continuous(limits = c(0, 80), labels = seq(0, 80, 20), breaks = seq(0, 80, 20)) +
  geom_text(data = subset(Females_AllAges_0814, is.na(adj.RD.suicide)==F), 
            aes(x = adjusted.suicide.white + 2, label = paste0("+", round(-adj.RD.suicide))), size = 3, col = "#fd8d3c") +
  facet_wrap(~type)
```


The suicide rates for blacks and whites are correlated. The ratio of white to black suicides is approximately X:1.

```{r, echo=F, warning=F}
ggplot(Males_AllAges_0814, aes(adjusted.suicide.white, adjusted.suicide.black)) + 
  geom_text(aes(label = ST, col = type), size = 2.5) +
  guides(color = guide_legend(title = " ")) +
  ylab("Suicide rate for blacks") +
  xlab("Suicide rate for whites") +
  theme_bw()

Males_AllAges_0814 %>% 
  group_by(type) %>% 
  summarise(cor.suicide = cor(adjusted.suicide.black, adjusted.suicide.white, use = "complete.obs"))

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(adjusted.suicide.white, adjusted.suicide.black)) + 
  geom_label(aes(label = ST, col = gun.level), size = 2.5, alpha = 0.5) +
  guides(color = guide_legend(title = " ")) +
  ylab("Suicide rate for blacks") +
  xlab("Suicide rate for whites") +
  theme_bw()

```

The homicide rates for blacks and whites are not correlated at all and are wildly different in magnitude.

```{r, echo=F, warning=F}
ggplot(Males_AllAges_0814, aes(adjusted.homicide.white, adjusted.homicide.black)) + 
  geom_text(aes(label = ST, col = type), size = 2.5) +
  ylab("Homicide rate for blacks") +
  xlab("Homicide rate for whites") +
  theme_bw()

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(adjusted.homicide.white, adjusted.homicide.black)) + 
  geom_label(aes(label = ST, col = gun.level), size = 2.5, alpha = 0.5) +
  ylab("Homicide rate for blacks") +
  xlab("Homicide rate for whites") +
  theme_bw()

```

```{r, echo=F, eval=F}
NHBM_1214 <- read.csv("/Users/corinneriddell/Dropbox/Funding/WilliamTGrant/Data/NHBlackMales_byState_1214.csv", header = T)
NHBM_1214 <- NHBM_1214 %>% 
  rename(deaths.black = Deaths, pop.black = Population) %>% 
  mutate(Race = "Non-Hispanic Black", crude.black = (deaths.black/pop.black)*100000) %>%
  select(ST, deaths.black, pop.black, crude.black)

NHWM_1214 <- read.csv("/Users/corinneriddell/Dropbox/Funding/WilliamTGrant/Data/NHWhiteMales_byState_1214.csv", header = T)
NHWM_1214 <- NHWM_1214 %>% 
  rename(deaths.white = Deaths, pop.white = Population) %>% 
  mutate(Race = "Non-Hispanic White", crude.white = (deaths.white/pop.white)*100000) %>% 
  select(ST, deaths.white, pop.white, crude.white)

HM_1214 <- read.csv("/Users/corinneriddell/Dropbox/Funding/WilliamTGrant/Data/HispanicMales_byState_1214.csv", header = T)
HM_1214 <- HM_1214 %>% 
  rename(deaths.hispanic = Deaths, pop.hispanic = Population) %>% 
  mutate(Race = "Hispanic", crude.hispanic = (deaths.hispanic/pop.hispanic)*100000) %>% 
  select(ST, deaths.hispanic, pop.hispanic, crude.hispanic)

dat.1214 <- merge(NHBM_1214, NHWM_1214, by = c("ST")) %>% mutate(BW.RD = crude.black - crude.white)
dat.1214 <- merge(dat.1214, HM_1214, by = c("ST")) %>% mutate(HW.RD = crude.hispanic - crude.white)

dat.1214 <- dat.1214 %>% mutate(ST.order.BW.RD = reorder(ST, BW.RD),
                                ST.order.HW.RD = reorder(ST, HW.RD)) %>% arrange(BW.RD)
```

```{r, echo=F, eval=F}
ggplot(subset(dat.1214, is.na(BW.RD) == F), aes(y = ST.order.BW.RD, x = crude.white)) + 
  geom_segment(aes(x = crude.white, xend = crude.black, y = ST.order.BW.RD, yend = ST.order.BW.RD), lwd = 1.5, col = "grey") +
  geom_point(aes(col = "White")) + geom_point(aes(x = crude.black, col = "Black")) + 
  scale_color_manual(values = c("navy", "#feb24c")) +
  ylab("") + xlab("Firearm mortality per 100k") + theme_bw() + 
  guides(color = guide_legend(title = " ")) + 
  ggtitle("Figure 1. Number of firearm fatalities, \nnon-Hispanic blacks vs. non-Hispanic whites, \n5 to 24 years old, 2012-2014") +
  theme(legend.position = c(0.8, 0.13), plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2))) + 
  labs(caption = "(Fig. created by Riddell. Data from WISQARS)") +
  scale_x_continuous(limits = c(0, 90), labels = seq(0, 80, 20), breaks = seq(0, 80, 20)) +
  geom_text(aes(x = crude.black + 8, label = paste0("+", round(BW.RD))
                ), size = 3) 
```

```{r, echo=F, eval=F}
ggplot(subset(dat.1214, is.na(HW.RD) == F), aes(y = ST.order.HW.RD, x = crude.white)) + 
  geom_segment(aes(x = crude.white, xend = crude.hispanic, y = ST.order.HW.RD, yend = ST.order.HW.RD), lwd = 1.5, col = "grey") +
  geom_point(aes(col = "White")) + geom_point(aes(x = crude.hispanic, col = "Hispanic")) + 
  scale_color_manual(values = c("red", "#feb24c")) +
  ylab("") + xlab("Firearm mortality per 100k") + theme_bw() + 
  guides(color = guide_legend(title = " ")) + 
  ggtitle("Figure 2. Number of firearm fatalities, \nHispanic vs. non-Hispanic whites, \n 5 to 24 years old, 2012-2014") +
  theme(legend.position = c(0.8, 0.13), plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2))) + 
  labs(caption = "(Fig. created by Riddell. Data from WISQARS)") +
  scale_x_continuous(limits = c(0, 20), labels = seq(0, 20, 4), breaks = seq(0, 20, 4)) +
  geom_text(data = subset(dat.1214, HW.RD>=0), aes(x = crude.hispanic + 1, label = paste0("+", round(HW.RD))
                ), size = 3) +
  geom_text(data = subset(dat.1214, HW.RD<0), aes(x = crude.hispanic - 1, label = round(HW.RD)
                ), size = 3) 
```

```{r, echo=F, eval=F}
dat.1214$ST.order.BW.RD <- forcats::fct_relevel(f = dat.1214$ST.order.BW.RD,
                                                "HI", "NH", "VT", "ME", "SD", "MT", "ID", "ND", "WY", "AK", "DE", "DC",
                                                "UT", "OR", "WA", "AZ", "CO", "IA", "MN", "TX", "VA",
                                                "SC", "GA", "NV", "WV", "NC", "MS", "MA",
                                                "NY", "KY", "KS", "AR", "CT", "NM", "MD",
                                                "FL", "AL", "OK", "NE", "WI", "TN", "CA",
                                                "LA", "NJ", "OH", "MO", "MI", "PA", "IN",
                                                "IL")

ggplot(dat.1214, aes(y = ST.order.BW.RD, x = crude.white)) + 
  geom_segment(aes(x = crude.white, xend = crude.black, y = ST.order.BW.RD, yend = ST.order.BW.RD), lwd = 2, col = "navy", alpha = 0.5) +
  geom_segment(aes(x = crude.white, xend = crude.hispanic, y = ST.order.BW.RD, yend = ST.order.BW.RD), lwd = 1, col = "red", alpha = 0.5) +
  geom_point(aes(col = "NH White")) + 
  geom_point(aes(x = crude.black, col = "NH Black")) + 
  geom_point(aes(x = crude.hispanic, col = "Hispanic")) +
  scale_color_manual(values = c("red", "navy", "#feb24c")) +
  ylab("") + xlab("Firearm mortality per 100k") + theme_bw() + 
  guides(color = guide_legend(title = " ")) + 
  ggtitle("Figure 1. Number of firearm fatalities to boys and men aged 5 to 24 years old, 2012-2014") +
  theme(legend.position = c(0.8, 0.13), plot.title = element_text(size = 10),
        legend.background = element_rect(fill=alpha('white', 0.2))) + 
  #labs(caption = "(Fig. created by Riddell. Data from WISQARS)") +
  scale_x_continuous(limits = c(0, 90), labels = seq(0, 80, 20), breaks = seq(0, 80, 20)) +
  geom_text(data = subset(dat.1214, is.na(BW.RD)==F), aes(x = crude.black + 8, label = paste0("+", round(BW.RD))
                ), size = 3, col = "navy") +
  geom_text(data = subset(dat.1214, is.na(HW.RD)==F & HW.RD>=0), aes(x = crude.hispanic + 3, label = paste0("+", round(HW.RD))
                ), size = 3, col = "red") +
  geom_text(data = subset(dat.1214, is.na(HW.RD)==F & HW.RD<0), aes(x = crude.hispanic - 3, label = round(HW.RD)
                ), size = 3, col = "red") 
```

```{r Figure 3_OLD_versions, fig.width=9, fig.height=3, echo = F, warning=F, eval=F}
ggplot(Males_AllAges_0814, aes(adjusted.suicide.white, adjusted.homicide.white)) + 
  geom_text(aes(label = ST, col = type), size = 2.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("Age-standardized white homicide rate\n(per 100,000)") +
  xlab("Age-standardized white suicide rate (per 100,000)") + 
  coord_equal(xlim = c(5, 45)) + theme_bw()

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(crude.suicide.white, crude.homicide.white)) + 
  geom_label(aes(label = ST, col = gun.level, size = average.pop.white), alpha = 0.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("White Homicide Rate\n(per 100,000)") +
  xlab("White Suicide Rate (per 100,000)") + 
  theme_bw() +
  coord_equal(xlim = c(5, 45)) 

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(crude.suicide.white, crude.homicide.white)) + 
  geom_label(aes(label = ST, col = gun.level, size = average.pop.white), alpha = 0.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("White Homicide Rate\n(per 100,000)") +
  xlab("White Suicide Rate (per 100,000)") + 
  theme_bw()
```

```{r figure4_OLD_versions, fig.height=3, fig.width=9, echo=F, warning=F, eval=F}
ggplot(Males_AllAges_0814, aes(crude.suicide.black, crude.homicide.black)) + 
  geom_text(aes(label = ST, col = type), size = 2.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("Black Homicide Rate (per 100,000)") +
  xlab("Black Suicide Rate\n(per 100,000)") + 
  coord_equal(ylim = c(5, 65)) + theme_bw()

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(crude.suicide.black, crude.homicide.black)) + 
  geom_label(aes(label = ST, col = gun.level, size = average.pop.black), alpha = 0.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("Black Homicide Rate (per 100,000)") +
  xlab("Black Suicide Rate\n(per 100,000)") + 
  coord_equal(ylim = c(5, 65)) + theme_bw()

ggplot(subset(Males_AllAges_0814, type == "Firearm"), aes(crude.suicide.black, crude.homicide.black)) + 
  geom_label(aes(label = ST, col = gun.level, size = average.pop.black), alpha = 0.5) +
  guides(color = guide_legend(title = " ")) + 
  ylab("Black Homicide Rate (per 100,000)") +
  xlab("Black Suicide Rate\n(per 100,000)") + 
  theme_bw()

```

#####PAGE BREAK

###References